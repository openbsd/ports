$OpenBSD: patch-makefile,v 1.5 2003/02/02 20:24:47 fgsch Exp $
--- makefile.orig	Mon Jan 13 20:36:40 2003
+++ makefile	Sun Feb  2 17:04:30 2003
@@ -3,24 +3,25 @@
 # Note: -O2 is sometimes broken in GCC when setjump/longjump is being
 # used. Try -O2 only with released simulators.
 #
-ifeq ($(WIN32),)
+#ifeq ($(WIN32),)
 #Unix Environments
-CC = gcc -O2 -lm -I . 
+#CC = gcc -O2 -lm -I . 
 #CC = gcc -O2 -g -lm -I . 
-ifeq ($(USE_NETWORK),)
-else
+CFLAGS += -lm -I.
+#ifeq ($(USE_NETWORK),)
+#else
 NETWORK_OPT = -DUSE_NETWORK -lpcap
-endif
-else
+#endif
+#else
 #Win32 Environments
-LDFLAGS = -lm -lwsock32
-CC = gcc -O0 -I.
-EXE = .exe
-ifeq ($(USE_NETWORK),)
-else
-NETWORK_OPT = -DUSE_NETWORK -lwpcap -lpacket
-endif
-endif
+#LDFLAGS = -lm -lwsock32
+#CC = gcc -O0 -I.
+#EXE = .exe
+#ifeq ($(USE_NETWORK),)
+#else
+#NETWORK_OPT = -DUSE_NETWORK -lwpcap -lpacket
+#endif
+#endif
 
 
 #
@@ -225,108 +226,108 @@ all : ${BIN}pdp1${EXE} ${BIN}pdp4${EXE} 
 # Individual builds
 #
 ${BIN}pdp1${EXE} : ${PDP1} ${SIM}
-	${CC} ${PDP1} ${SIM} ${PDP1_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${PDP1} ${SIM} ${PDP1_OPT} -o $@ ${LDFLAGS}
 
 
 
 ${BIN}pdp4${EXE} : ${PDP18B} ${SIM}
-	${CC} ${PDP18B} ${SIM} ${PDP4_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${PDP18B} ${SIM} ${PDP4_OPT} -o $@ ${LDFLAGS}
 
 
 
 ${BIN}pdp7${EXE} : ${PDP18B} ${SIM}
-	${CC} ${PDP18B} ${SIM} ${PDP7_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${PDP18B} ${SIM} ${PDP7_OPT} -o $@ ${LDFLAGS}
 
 
 
 ${BIN}pdp8${EXE} : ${PDP8} ${SIM}
-	${CC} ${PDP8} ${SIM} ${PDP8_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${PDP8} ${SIM} ${PDP8_OPT} -o $@ ${LDFLAGS}
 
 
 
 ${BIN}pdp9${EXE} : ${PDP18B} ${SIM}
-	${CC} ${PDP18B} ${SIM} ${PDP9_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${PDP18B} ${SIM} ${PDP9_OPT} -o $@ ${LDFLAGS}
 
 
 
 ${BIN}pdp15${EXE} : ${PDP18B} ${SIM}
-	${CC} ${PDP18B} ${SIM} ${PDP15_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${PDP18B} ${SIM} ${PDP15_OPT} -o $@ ${LDFLAGS}
 
 
 
 ${BIN}pdp10${EXE} : ${PDP10} ${SIM}
-	${CC} ${PDP10} ${SIM} ${PDP10_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${PDP10} ${SIM} ${PDP10_OPT} -o $@ ${LDFLAGS}
 
 
 
 ${BIN}pdp11${EXE} : ${PDP11} ${SIM}
-	${CC} ${PDP11} ${SIM} ${PDP11_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${PDP11} ${SIM} ${PDP11_OPT} -o $@ ${LDFLAGS}
 
 
 
 ${BIN}vax${EXE} : ${VAX} ${SIM}
-	${CC} ${VAX} ${SIM} ${VAX_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${VAX} ${SIM} ${VAX_OPT} -o $@ ${LDFLAGS}
 
 
 
 ${BIN}nova${EXE} : ${NOVA} ${SIM}
-	${CC} ${NOVA} ${SIM} ${NOVA_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${NOVA} ${SIM} ${NOVA_OPT} -o $@ ${LDFLAGS}
 
 
 
 ${BIN}eclipse${EXE} : ${ECLIPSE} ${SIM}
-	${CC} ${ECLIPSE} ${SIM} ${ECLIPSE_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${ECLIPSE} ${SIM} ${ECLIPSE_OPT} -o $@ ${LDFLAGS}
 
 
 
 ${BIN}h316${EXE} : ${H316} ${SIM}
-	${CC} ${H316} ${SIM} ${H316_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${H316} ${SIM} ${H316_OPT} -o $@ ${LDFLAGS}
 
 
 
 ${BIN}hp2100${EXE} : ${HP2100} ${SIM}
-	${CC} ${HP2100} ${SIM} ${HP2100_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${HP2100} ${SIM} ${HP2100_OPT} -o $@ ${LDFLAGS}
 
 
 
 ${BIN}i1401${EXE} : ${I1401} ${SIM}
-	${CC} ${I1401} ${SIM} ${I1401_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${I1401} ${SIM} ${I1401_OPT} -o $@ ${LDFLAGS}
 
 
 
 ${BIN}i1620${EXE} : ${I1620} ${SIM}
-	${CC} ${I1620} ${SIM} ${I1620_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${I1620} ${SIM} ${I1620_OPT} -o $@ ${LDFLAGS}
 
 
 ${BIN}ibm1130${EXE} : ${IBM1130}
-	${CC} ${IBM1130} ${SIM} ${IBM1130_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${IBM1130} ${SIM} ${IBM1130_OPT} -o $@ ${LDFLAGS}
 
 
 ${BIN}s3${EXE} : ${S3} ${SIM}
-	${CC} ${S3} ${SIM} ${S3_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${S3} ${SIM} ${S3_OPT} -o $@ ${LDFLAGS}
 
 
 ${BIN}altair${EXE} : ${ALTAIR} ${SIM}
-	${CC} ${ALTAIR} ${SIM} ${ALTAIR_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${ALTAIR} ${SIM} ${ALTAIR_OPT} -o $@ ${LDFLAGS}
 
 
 ${BIN}altairz80${EXE} : ${ALTAIRZ80} ${SIM} 
-	${CC} ${ALTAIRZ80} ${SIM} ${ALTAIRZ80_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${ALTAIRZ80} ${SIM} ${ALTAIRZ80_OPT} -o $@ ${LDFLAGS}
 
 
 ${BIN}gri${EXE} : ${GRI} ${SIM}
-	${CC} ${GRI} ${SIM} ${GRI_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${GRI} ${SIM} ${GRI_OPT} -o $@ ${LDFLAGS}
 
 
 ${BIN}id16${EXE} : ${ID16} ${SIM}
-	${CC} ${ID16} ${SIM} ${ID16_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${ID16} ${SIM} ${ID16_OPT} -o $@ ${LDFLAGS}
 
 
 ${BIN}id32${EXE} : ${ID32} ${SIM}
-	${CC} ${ID32} ${SIM} ${ID32_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${ID32} ${SIM} ${ID32_OPT} -o $@ ${LDFLAGS}
 
 
 ${BIN}sds${EXE} : ${SDS} ${SIM}
-	${CC} ${SDS} ${SIM} ${SDS_OPT} -o $@ ${LDFLAGS}
+	${CC} ${CFLAGS} ${SDS} ${SIM} ${SDS_OPT} -o $@ ${LDFLAGS}
 
 
