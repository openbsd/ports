Index: cmake/MacroCreateLibtoolFile.cmake
--- cmake/MacroCreateLibtoolFile.cmake.orig
+++ cmake/MacroCreateLibtoolFile.cmake
@@ -8,46 +8,104 @@ MACRO(GET_TARGET_PROPERTY_WITH_DEFAULT _variable _targ
   ENDIF (${_variable} MATCHES NOTFOUND)
 ENDMACRO (GET_TARGET_PROPERTY_WITH_DEFAULT)
 
-MACRO(CREATE_LIBTOOL_FILE _target _install_DIR)
-  GET_TARGET_PROPERTY(_target_location ${_target} LOCATION)
-  GET_TARGET_PROPERTY_WITH_DEFAULT(_target_static_lib ${_target} STATIC_LIB "")
-  GET_TARGET_PROPERTY_WITH_DEFAULT(_target_dependency_libs ${_target} LT_DEPENDENCY_LIBS "")
-  GET_TARGET_PROPERTY_WITH_DEFAULT(_target_current ${_target} LT_VERSION_CURRENT 0)
-  GET_TARGET_PROPERTY_WITH_DEFAULT(_target_age ${_target} LT_VERSION_AGE 0)
-  GET_TARGET_PROPERTY_WITH_DEFAULT(_target_revision ${_target} LT_VERSION_REVISION 0)
-  GET_TARGET_PROPERTY_WITH_DEFAULT(_target_installed ${_target} LT_INSTALLED yes)
-  GET_TARGET_PROPERTY_WITH_DEFAULT(_target_shouldnotlink ${_target} LT_SHOULDNOTLINK yes)
-  GET_TARGET_PROPERTY_WITH_DEFAULT(_target_dlopen ${_target} LT_DLOPEN "")
-  GET_TARGET_PROPERTY_WITH_DEFAULT(_target_dlpreopen ${_target} LT_DLPREOPEN "")
-  GET_FILENAME_COMPONENT(_laname ${_target_location} NAME_WE)
-  GET_FILENAME_COMPONENT(_soname ${_target_location} NAME)
-  SET(_laname ${PROJECT_BINARY_DIR}/${_laname}.la)
-  FILE(WRITE ${_laname} "# ${_laname} - a libtool library file\n")
-  FILE(WRITE ${_laname} "# Generated by CMake ${CMAKE_VERSION} (like GNU libtool)\n")
-  FILE(WRITE ${_laname} "\n# Please DO NOT delete this file!\n# It is necessary for linking the library with libtool.\n\n" )
-  FILE(APPEND ${_laname} "# The name that we can dlopen(3).\n")
-  FILE(APPEND ${_laname} "dlname='${_soname}'\n\n")
-  FILE(APPEND ${_laname} "# Names of this library.\n")
-  FILE(APPEND ${_laname} "library_names='${_soname}.${_target_current}.${_target_age}.${_target_revision} ${_soname}.${_target_current} ${_soname}'\n\n")
-  FILE(APPEND ${_laname} "# The name of the static archive.\n")
-  FILE(APPEND ${_laname} "old_library='${_target_static_lib}'\n\n")
-  FILE(APPEND ${_laname} "# Libraries that this one depends upon.\n")
-  FILE(APPEND ${_laname} "dependency_libs='${_target_dependency_libs}'\n\n")
-  FILE(APPEND ${_laname} "# Names of additional weak libraries provided by this library\n")
-  FILE(APPEND ${_laname} "weak_library_names=''\n\n")
-  FILE(APPEND ${_laname} "# Version information for ${_laname}.\n")
-  FILE(APPEND ${_laname} "current=${_target_current}\n")
-  FILE(APPEND ${_laname} "age=${_target_age}\n")
-  FILE(APPEND ${_laname} "revision=${_target_revision}\n\n")
-  FILE(APPEND ${_laname} "# Is this an already installed library?\n")
-  FILE(APPEND ${_laname} "installed=${_target_installed}\n\n")
-  FILE(APPEND ${_laname} "# Should we warn about portability when linking against -modules?\n")
-  FILE(APPEND ${_laname} "shouldnotlink=${_target_shouldnotlink}\n\n")
-  FILE(APPEND ${_laname} "# Files to dlopen/dlpreopen\n")
-  FILE(APPEND ${_laname} "dlopen='${_target_dlopen}'\n")
-  FILE(APPEND ${_laname} "dlpreopen='${_target_dlpreopen}'\n\n")
-  FILE(APPEND ${_laname} "# Directory that this library needs to be installed in:\n")
-  FILE(APPEND ${_laname} "libdir='${CMAKE_INSTALL_PREFIX}${_install_DIR}'\n")
-#  INSTALL( FILES ${_laname} ${_soname}  DESTINATION ${CMAKE_INSTALL_PREFIX}${_install_DIR})
-  INSTALL( FILES ${_laname} DESTINATION ${CMAKE_INSTALL_PREFIX}${_install_DIR})
-ENDMACRO(CREATE_LIBTOOL_FILE)
+macro(CREATE_LIBTOOL_FILE _target _install_DIR)
+  get_target_property(_target_static_lib ${_target} STATIC_LIB)
+  if(NOT _target_static_lib)
+    set(_target_static_lib "")
+  endif()
+
+  get_target_property(_target_dependency_libs ${_target} LT_DEPENDENCY_LIBS)
+  if(NOT _target_dependency_libs)
+    set(_target_dependency_libs "")
+  endif()
+
+  get_target_property(_target_current ${_target} LT_VERSION_CURRENT)
+  if(NOT _target_current)
+    set(_target_current 0)
+  endif()
+
+  get_target_property(_target_age ${_target} LT_VERSION_AGE)
+  if(NOT _target_age)
+    set(_target_age 0)
+  endif()
+
+  get_target_property(_target_revision ${_target} LT_VERSION_REVISION)
+  if(NOT _target_revision)
+    set(_target_revision 0)
+  endif()
+
+  get_target_property(_target_installed ${_target} LT_INSTALLED)
+  if(NOT _target_installed)
+    set(_target_installed yes)
+  endif()
+
+  get_target_property(_target_shouldnotlink ${_target} LT_SHOULDNOTLINK)
+  if(NOT _target_shouldnotlink)
+    set(_target_shouldnotlink no)
+  endif()
+
+  get_target_property(_target_dlopen ${_target} LT_DLOPEN)
+  if(NOT _target_dlopen)
+    set(_target_dlopen "")
+  endif()
+
+  get_target_property(_target_dlpreopen ${_target} LT_DLPREOPEN)
+  if(NOT _target_dlpreopen)
+    set(_target_dlpreopen "")
+  endif()
+
+  # Verwende Output-Name statt LOCATION
+  get_target_property(_target_output_name ${_target} OUTPUT_NAME)
+  if(NOT _target_output_name)
+    set(_target_output_name ${_target})
+  endif()
+
+  # .la Dateiname erstellen
+  set(_laname ${PROJECT_BINARY_DIR}/lib${_target_output_name}.la)
+  set(_soname lib${_target_output_name}.so)
+
+  # .la Datei mit file(GENERATE) erstellen - wird zur Build-Zeit ausgewertet
+  set(_la_content "# lib${_target_output_name}.la - a libtool library file
+# Generated by CMake ${CMAKE_VERSION} (like GNU libtool)
+
+# Please DO NOT delete this file!
+# It is necessary for linking the library with libtool.
+
+# The name that we can dlopen(3).
+dlname='${_soname}.${LIBwv2_VERSION}'
+
+# Names of this library.
+library_names='${_soname}.${LIBwv2_VERSION} ${_soname}.${LIBwv2_VERSION} ${_soname}.${LIBwv2_VERSION}'
+
+# The name of the static archive.
+old_library='${_target_static_lib}'
+
+# Libraries that this one depends upon.
+dependency_libs='${_target_dependency_libs}'
+
+# Names of additional weak libraries provided by this library
+weak_library_names=''
+
+# Version information for lib${_target_output_name}.la.
+current=${_target_current}
+age=${_target_age}
+revision=${_target_revision}
+
+# Is this an already installed library?
+installed=${_target_installed}
+
+# Should we warn about portability when linking against -modules?
+shouldnotlink=${_target_shouldnotlink}
+
+# Files to dlopen/dlpreopen
+dlopen='${_target_dlopen}'
+dlpreopen='${_target_dlpreopen}'
+
+# Directory that this library needs to be installed in:
+libdir='${CMAKE_INSTALL_PREFIX}${_install_DIR}'
+")
+
+  file(GENERATE OUTPUT ${_laname} CONTENT "${_la_content}")
+
+  install(FILES ${_laname} DESTINATION ${CMAKE_INSTALL_PREFIX}${_install_DIR})
+endmacro()
