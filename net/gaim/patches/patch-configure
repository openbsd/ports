$OpenBSD: patch-configure,v 1.18 2004/12/10 20:57:08 fgsch Exp $
--- configure.orig	Fri Dec  3 01:24:48 2004
+++ configure	Fri Dec 10 02:22:25 2004
@@ -464,7 +464,7 @@ ac_includes_default="\
 # include <unistd.h>
 #endif"
 
-ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS build build_cpu build_vendor build_os host host_cpu host_vendor host_os target target_cpu target_vendor target_os INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA CYGPATH_W PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO install_sh STRIP ac_ct_STRIP INSTALL_STRIP_PROGRAM mkdir_p AWK SET_MAKE am__leading_dot AMTAR am__tar am__untar sedpath CC CFLAGS LDFLAGS CPPFLAGS ac_ct_CC EXEEXT OBJEXT DEPDIR am__include am__quote AMDEP_TRUE AMDEP_FALSE AMDEPBACKSLASH CCDEPMODE am__fastdepCC_TRUE am__fastdepCC_FALSE EGREP LN_S ECHO AR ac_ct_AR RANLIB ac_ct_RANLIB CPP CXX CXXFLAGS ac_ct_CXX CXXDEPMODE am__fastdepCXX_TRUE am__fastdepCXX_FALSE CXXCPP F77 FFLAGS ac_ct_F77 LIBTOOL MKINSTALLDIRS USE_NLS MSGFMT GMSGFMT XGETTEXT MSGMERGE ALLOCA GLIBC21 HAVE_POSIX_PRINTF HAVE_ASPRINTF HAVE_SNPRINTF HAVE_WPRINTF LIBICONV LTLIBICONV INTLBISON BUILD_INCLUDED_LIBINTL USE_INCLUDED_LIBINTL CATOBJEXT DATADIRNAME INSTOBJEXT GENCAT INTLOBJS INTL_LIBTOOL_SUFFIX_PREFIX INTLLIBS LIBINTL LTLIBINTL POSUB LIBOBJS PKG_CONFIG SILC_CFLAGS SILC_LIBS DISTRIB_TRUE DISTRIB_FALSE STATIC_PRPLS STATIC_GG_TRUE STATIC_GG_FALSE STATIC_IRC_TRUE STATIC_IRC_FALSE STATIC_JABBER_TRUE STATIC_JABBER_FALSE STATIC_MSN_TRUE STATIC_MSN_FALSE STATIC_NAPSTER_TRUE STATIC_NAPSTER_FALSE STATIC_NOVELL_TRUE STATIC_NOVELL_FALSE STATIC_OSCAR_TRUE STATIC_OSCAR_FALSE STATIC_RENDEZVOUS_TRUE STATIC_RENDEZVOUS_FALSE STATIC_SILC_TRUE STATIC_SILC_FALSE STATIC_TOC_TRUE STATIC_TOC_FALSE STATIC_TREPIA_TRUE STATIC_TREPIA_FALSE STATIC_YAHOO_TRUE STATIC_YAHOO_FALSE STATIC_ZEPHYR_TRUE STATIC_ZEPHYR_FALSE STATIC_LINK_LIBS DYNAMIC_PRPLS DYNAMIC_GG_TRUE DYNAMIC_GG_FALSE DYNAMIC_IRC_TRUE DYNAMIC_IRC_FALSE DYNAMIC_JABBER_TRUE DYNAMIC_JABBER_FALSE DYNAMIC_MSN_TRUE DYNAMIC_MSN_FALSE DYNAMIC_NAPSTER_TRUE DYNAMIC_NAPSTER_FALSE DYNAMIC_NOVELL_TRUE DYNAMIC_NOVELL_FALSE DYNAMIC_OSCAR_TRUE DYNAMIC_OSCAR_FALSE DYNAMIC_RENDEZVOUS_TRUE DYNAMIC_RENDEZVOUS_FALSE DYNAMIC_SILC_TRUE DYNAMIC_SILC_FALSE DYNAMIC_TOC_TRUE DYNAMIC_TOC_FALSE DYNAMIC_TREPIA_TRUE DYNAMIC_TREPIA_FALSE DYNAMIC_YAHOO_TRUE DYNAMIC_YAHOO_FALSE DYNAMIC_ZEPHYR_TRUE DYNAMIC_ZEPHYR_FALSE EXTERNAL_LIBZEPHYR_TRUE EXTERNAL_LIBZEPHYR_FALSE GLIB_CFLAGS GLIB_LIBS GLIB_GENMARSHAL GOBJECT_QUERY GLIB_MKENUMS GTK_CFLAGS GTK_LIBS gaimpath X_CFLAGS X_PRE_LIBS X_LIBS X_EXTRA_LIBS STARTUP_NOTIFICATION_CFLAGS STARTUP_NOTIFICATION_LIBS EVOLUTION_ADDRESSBOOK_CFLAGS EVOLUTION_ADDRESSBOOK_LIBS BUILD_GEVOLUTION_TRUE BUILD_GEVOLUTION_FALSE XSS_LIBS SM_LIBS perlpath PERL USE_PERL_TRUE USE_PERL_FALSE PERL_CFLAGS PERL_LIBS PERL_MM_PARAMS DYNALOADER_A LIBPERL_A GNUTLS_CFLAGS GNUTLS_LIBS USE_GNUTLS_TRUE USE_GNUTLS_FALSE NSS_CFLAGS NSS_LIBS USE_NSS_TRUE USE_NSS_FALSE USE_TCL_TRUE USE_TCL_FALSE TCL_LIBS TCL_CFLAGS USE_TK_TRUE USE_TK_FALSE TK_LIBS GTKSPELL_CFLAGS GTKSPELL_LIBS AO_CFLAGS AO_LIBS AUDIOFILE_CONFIG AUDIOFILE_CFLAGS AUDIOFILE_LIBS SOUND_LIBS DEBUG_CFLAGS LDADD PLUGINS_TRUE PLUGINS_FALSE PRPLS_TRUE PRPLS_FALSE KRB4_CFLAGS KRB4_LDFLAGS KRB4_LIBS ZEPHYR_CFLAGS ZEPHYR_LDFLAGS ZEPHYR_LIBS BINRELOC_CFLAGS BINRELOC_LIBS LTLIBOBJS'
+ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS build build_cpu build_vendor build_os host host_cpu host_vendor host_os target target_cpu target_vendor target_os INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA CYGPATH_W PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO install_sh STRIP ac_ct_STRIP INSTALL_STRIP_PROGRAM mkdir_p AWK SET_MAKE am__leading_dot AMTAR am__tar am__untar sedpath CC CFLAGS LDFLAGS CPPFLAGS ac_ct_CC EXEEXT OBJEXT DEPDIR am__include am__quote AMDEP_TRUE AMDEP_FALSE AMDEPBACKSLASH CCDEPMODE am__fastdepCC_TRUE am__fastdepCC_FALSE EGREP LN_S ECHO AR ac_ct_AR RANLIB ac_ct_RANLIB CPP CXX CXXFLAGS ac_ct_CXX CXXDEPMODE am__fastdepCXX_TRUE am__fastdepCXX_FALSE CXXCPP F77 FFLAGS ac_ct_F77 LIBTOOL MKINSTALLDIRS USE_NLS MSGFMT GMSGFMT XGETTEXT MSGMERGE ALLOCA GLIBC21 HAVE_POSIX_PRINTF HAVE_ASPRINTF HAVE_SNPRINTF HAVE_WPRINTF LIBICONV LTLIBICONV INTLBISON BUILD_INCLUDED_LIBINTL USE_INCLUDED_LIBINTL CATOBJEXT DATADIRNAME INSTOBJEXT GENCAT INTLOBJS INTL_LIBTOOL_SUFFIX_PREFIX INTLLIBS LIBINTL LTLIBINTL POSUB LIBOBJS PKG_CONFIG SILC_CFLAGS SILC_LIBS DISTRIB_TRUE DISTRIB_FALSE STATIC_PRPLS STATIC_GG_TRUE STATIC_GG_FALSE STATIC_IRC_TRUE STATIC_IRC_FALSE STATIC_JABBER_TRUE STATIC_JABBER_FALSE STATIC_MSN_TRUE STATIC_MSN_FALSE STATIC_NAPSTER_TRUE STATIC_NAPSTER_FALSE STATIC_NOVELL_TRUE STATIC_NOVELL_FALSE STATIC_OSCAR_TRUE STATIC_OSCAR_FALSE STATIC_RENDEZVOUS_TRUE STATIC_RENDEZVOUS_FALSE STATIC_SILC_TRUE STATIC_SILC_FALSE STATIC_TOC_TRUE STATIC_TOC_FALSE STATIC_TREPIA_TRUE STATIC_TREPIA_FALSE STATIC_YAHOO_TRUE STATIC_YAHOO_FALSE STATIC_ZEPHYR_TRUE STATIC_ZEPHYR_FALSE STATIC_LINK_LIBS DYNAMIC_PRPLS DYNAMIC_GG_TRUE DYNAMIC_GG_FALSE DYNAMIC_IRC_TRUE DYNAMIC_IRC_FALSE DYNAMIC_JABBER_TRUE DYNAMIC_JABBER_FALSE DYNAMIC_MSN_TRUE DYNAMIC_MSN_FALSE DYNAMIC_NAPSTER_TRUE DYNAMIC_NAPSTER_FALSE DYNAMIC_NOVELL_TRUE DYNAMIC_NOVELL_FALSE DYNAMIC_OSCAR_TRUE DYNAMIC_OSCAR_FALSE DYNAMIC_RENDEZVOUS_TRUE DYNAMIC_RENDEZVOUS_FALSE DYNAMIC_SILC_TRUE DYNAMIC_SILC_FALSE DYNAMIC_TOC_TRUE DYNAMIC_TOC_FALSE DYNAMIC_TREPIA_TRUE DYNAMIC_TREPIA_FALSE DYNAMIC_YAHOO_TRUE DYNAMIC_YAHOO_FALSE DYNAMIC_ZEPHYR_TRUE DYNAMIC_ZEPHYR_FALSE EXTERNAL_LIBZEPHYR_TRUE EXTERNAL_LIBZEPHYR_FALSE GLIB_CFLAGS GLIB_LIBS GLIB_GENMARSHAL GOBJECT_QUERY GLIB_MKENUMS GTK_CFLAGS GTK_LIBS gaimpath X_CFLAGS X_PRE_LIBS X_LIBS X_EXTRA_LIBS STARTUP_NOTIFICATION_CFLAGS STARTUP_NOTIFICATION_LIBS EVOLUTION_ADDRESSBOOK_CFLAGS EVOLUTION_ADDRESSBOOK_LIBS BUILD_GEVOLUTION_TRUE BUILD_GEVOLUTION_FALSE XSS_LIBS SM_LIBS perlpath PERL USE_PERL_TRUE USE_PERL_FALSE PERL_CFLAGS PERL_LIBS PERL_MM_PARAMS DYNALOADER_A LIBPERL_A OPENSSL_CFLAGS OPENSSL_LIBS USE_OPENSSL_TRUE USE_OPENSSL_FALSE GNUTLS_CFLAGS GNUTLS_LIBS USE_GNUTLS_TRUE USE_GNUTLS_FALSE NSS_CFLAGS NSS_LIBS USE_NSS_TRUE USE_NSS_FALSE USE_TCL_TRUE USE_TCL_FALSE TCL_LIBS TCL_CFLAGS USE_TK_TRUE USE_TK_FALSE TK_LIBS GTKSPELL_CFLAGS GTKSPELL_LIBS AO_CFLAGS AO_LIBS AUDIOFILE_CONFIG AUDIOFILE_CFLAGS AUDIOFILE_LIBS SOUND_LIBS DEBUG_CFLAGS LDADD PLUGINS_TRUE PLUGINS_FALSE PRPLS_TRUE PRPLS_FALSE KRB4_CFLAGS KRB4_LDFLAGS KRB4_LIBS ZEPHYR_CFLAGS ZEPHYR_LDFLAGS ZEPHYR_LIBS BINRELOC_CFLAGS BINRELOC_LIBS LTLIBOBJS'
 ac_subst_files=''
 
 # Initialize some variables set by options.
@@ -1059,6 +1059,7 @@ Optional Features:
   --disable-gtktest       do not try to compile and run a test GTK+ program
   --disable-startup-notification    compile without startup notification support
   --disable-gevolution    compile without the Gaim-Evolution plugin
+  --enable-openssl=yes,no Attempt to use OpenSSL for SSL support (preferred) default=yes
   --enable-gnutls=yes,no    Attempt to use GNUTLS for SSL support (preferred) default=yes
   --enable-nss=yes,no,static    Attempt to use Mozilla libnss for SSL support default=yes
   --disable-aotest       Do not try to compile and run a test ao program
@@ -1092,6 +1093,8 @@ Optional Packages:
   --with-x                use the X Window System
   --with-perl-lib=site|vendor|DIR  Specify where to install the
 								   Perl libraries for gaim. Default is site.
+  --with-openssl-includes=PREFIX  Location of OpenSSL includes.
+  --with-openssl-libs=PREFIX      Location of OpenSSL libraries.
   --with-gnutls-includes=PREFIX   Location of GNUTLS includes.
   --with-gnutls-libs=PREFIX       Location of GNUTLS libraries.
   --with-nspr-includes=PREFIX     Specify location of Mozilla nspr4 includes.
@@ -3698,12 +3701,10 @@ nto-qnx*)
   ;;
 
 openbsd*)
-  lt_cv_file_magic_cmd=/usr/bin/file
-  lt_cv_file_magic_test_file=`echo /usr/lib/libc.so.*`
   if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
-    lt_cv_deplibs_check_method='file_magic ELF [0-9][0-9]*-bit [LM]SB shared object'
+    lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|\.so|_pic\.a)$'
   else
-    lt_cv_deplibs_check_method='file_magic OpenBSD.* shared library'
+    lt_cv_deplibs_check_method='match_pattern /lib[^/]+(\.so\.[0-9]+\.[0-9]+|_pic\.a)$'
   fi
   ;;
 
@@ -5558,6 +5559,19 @@ else
     lt_cv_sys_max_cmd_len=8192;
     ;;
 
+  netbsd* | freebsd* | openbsd* | darwin* )
+    # This has been around since 386BSD, at least.  Likely further.
+    if test -x /sbin/sysctl; then
+      lt_cv_sys_max_cmd_len=`/sbin/sysctl -n kern.argmax`
+    elif test -x /usr/sbin/sysctl; then
+      lt_cv_sys_max_cmd_len=`/usr/sbin/sysctl -n kern.argmax`
+    else
+      lt_cv_sys_max_cmd_len=65536 # usable default for *BSD
+    fi
+    # And add a safety zone
+    lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \/ 4`
+    ;;
+
  *)
     # If test is not a shell built-in, we'll probably end up computing a
     # maximum length that is only half of the actual maximum length, but
@@ -7415,6 +7429,7 @@ if test -z "$aix_libpath"; then aix_libp
       hardcode_shlibpath_var=no
       if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
 	archive_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'
+	archive_expsym_cmds='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'
 	hardcode_libdir_flag_spec='${wl}-rpath,$libdir'
 	export_dynamic_flag_spec='${wl}-E'
       else
@@ -8111,7 +8126,7 @@ nto-qnx*)
 openbsd*)
   version_type=sunos
   need_lib_prefix=no
-  need_version=yes
+  need_version=no
   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${shared_ext}$versuffix'
   finish_cmds='PATH="\$PATH:/sbin" ldconfig -m $libdir'
   shlibpath_var=LD_LIBRARY_PATH
@@ -10522,6 +10537,23 @@ if test -z "$aix_libpath"; then aix_libp
     # Workaround some broken pre-1.5 toolchains
     output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | grep conftest.$objext | $SED -e "s:-lgcc -lc -lgcc::"'
     ;;
+  openbsd2*)
+      # C++ shared libraries are fairly broken
+      ld_shlibs_CXX=no
+      ;;
+  openbsd*)
+      hardcode_direct_CXX=yes
+      hardcode_shlibpath_var_CXX=no
+      archive_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'
+      hardcode_libdir_flag_spec_CXX='${wl}-rpath,$libdir'
+      if test -z "`echo __ELF__ | $CC -E - | grep __ELF__`" || test "$host_os-$host_cpu" = "openbsd2.8-powerpc"; then
+       archive_expsym_cmds_CXX='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-fil
+e,$export_symbols -o $lib'
+       export_dynamic_flag_spec_CXX='${wl}-E'
+       whole_archive_flag_spec_CXX="$wlarc"'--whole-archive$convenience '"$wlarc"'--no-whole-archive'
+      fi
+      output_verbose_link_cmd='echo'
+      ;;
   osf3*)
     case $cc_basename in
       KCC)
@@ -27839,7 +27871,7 @@ fi
 	if test "$ac_silc_libs" != "no"; then
 		SILC_LIBS="-L$ac_silc_libs"
 	fi
-	SILC_LIBS="$SILC_LIBS -lsilc -lsilcclient -lpthread -ldl"
+	SILC_LIBS="$SILC_LIBS -lsilc -lsilcclient -pthread"
 	echo "$as_me:$LINENO: checking for silc_client_init in -lsilcclient" >&5
 echo $ECHO_N "checking for silc_client_init in -lsilcclient... $ECHO_C" >&6
 if test "${ac_cv_lib_silcclient_silc_client_init+set}" = set; then
@@ -31984,6 +32016,14 @@ fi
 
 
 
+# Check whether --enable-openssl or --disable-openssl was given.
+if test "${enable_openssl+set}" = set; then
+  enableval="$enable_openssl"
+  enable_openssl="$enableval"
+else
+  enable_openssl="yes"
+fi;
+
 # Check whether --enable-gnutls or --disable-gnutls was given.
 if test "${enable_gnutls+set}" = set; then
   enableval="$enable_gnutls"
@@ -32002,6 +32042,299 @@ fi;
 
 msg_ssl="None"
 
+if test "x$enable_openssl" != "xno"; then
+	enable_openssl="no"
+	prefix=`eval echo $prefix`
+
+
+# Check whether --with-openssl-includes or --without-openssl-includes was given.
+if test "${with_openssl_includes+set}" = set; then
+  withval="$with_openssl_includes"
+   with_openssl_includes="$withval"
+else
+   with_openssl_includes="$prefix/include"
+fi;
+
+	have_openssl_includes="no"
+
+	if test "x$with_openssl_includes" != "xno"; then
+		CPPFLAGS_save="$CPPFLAGS"
+
+		echo "$as_me:$LINENO: checking for OpenSSL includes" >&5
+echo $ECHO_N "checking for OpenSSL includes... $ECHO_C" >&6
+		echo "$as_me:$LINENO: result: \"\"" >&5
+echo "${ECHO_T}\"\"" >&6
+
+		CPPFLAGS="$CPPFLAGS -I$with_openssl_includes"
+
+for ac_header in openssl/ssl.h
+do
+as_ac_Header=`echo "ac_cv_header_$ac_header" | $as_tr_sh`
+if eval "test \"\${$as_ac_Header+set}\" = set"; then
+  echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
+if eval "test \"\${$as_ac_Header+set}\" = set"; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+fi
+echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
+echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+else
+  # Is the header compilable?
+echo "$as_me:$LINENO: checking $ac_header usability" >&5
+echo $ECHO_N "checking $ac_header usability... $ECHO_C" >&6
+cat >conftest.$ac_ext <<_ACEOF
+#line $LINENO "configure"
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+$ac_includes_default
+#include <$ac_header>
+_ACEOF
+rm -f conftest.$ac_objext
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } &&
+         { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+  ac_header_compiler=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+ac_header_compiler=no
+fi
+rm -f conftest.$ac_objext conftest.$ac_ext
+echo "$as_me:$LINENO: result: $ac_header_compiler" >&5
+echo "${ECHO_T}$ac_header_compiler" >&6
+
+# Is the header present?
+echo "$as_me:$LINENO: checking $ac_header presence" >&5
+echo $ECHO_N "checking $ac_header presence... $ECHO_C" >&6
+cat >conftest.$ac_ext <<_ACEOF
+#line $LINENO "configure"
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+#include <$ac_header>
+_ACEOF
+if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
+  (eval $ac_cpp conftest.$ac_ext) 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } >/dev/null; then
+  if test -s conftest.err; then
+    ac_cpp_err=$ac_c_preproc_warn_flag
+  else
+    ac_cpp_err=
+  fi
+else
+  ac_cpp_err=yes
+fi
+if test -z "$ac_cpp_err"; then
+  ac_header_preproc=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+  ac_header_preproc=no
+fi
+rm -f conftest.err conftest.$ac_ext
+echo "$as_me:$LINENO: result: $ac_header_preproc" >&5
+echo "${ECHO_T}$ac_header_preproc" >&6
+
+# So?  What about this header?
+case $ac_header_compiler:$ac_header_preproc in
+  yes:no )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&5
+echo "$as_me: WARNING: $ac_header: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    (
+      cat <<\_ASBOX
+## ------------------------------------ ##
+## Report this to bug-autoconf@gnu.org. ##
+## ------------------------------------ ##
+_ASBOX
+    ) |
+      sed "s/^/$as_me: WARNING:     /" >&2
+    ;;
+  no:yes )
+    { echo "$as_me:$LINENO: WARNING: $ac_header: present but cannot be compiled" >&5
+echo "$as_me: WARNING: $ac_header: present but cannot be compiled" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: check for missing prerequisite headers?" >&5
+echo "$as_me: WARNING: $ac_header: check for missing prerequisite headers?" >&2;}
+    { echo "$as_me:$LINENO: WARNING: $ac_header: proceeding with the preprocessor's result" >&5
+echo "$as_me: WARNING: $ac_header: proceeding with the preprocessor's result" >&2;}
+    (
+      cat <<\_ASBOX
+## ------------------------------------ ##
+## Report this to bug-autoconf@gnu.org. ##
+## ------------------------------------ ##
+_ASBOX
+    ) |
+      sed "s/^/$as_me: WARNING:     /" >&2
+    ;;
+esac
+echo "$as_me:$LINENO: checking for $ac_header" >&5
+echo $ECHO_N "checking for $ac_header... $ECHO_C" >&6
+if eval "test \"\${$as_ac_Header+set}\" = set"; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  eval "$as_ac_Header=$ac_header_preproc"
+fi
+echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_Header'}'`" >&5
+echo "${ECHO_T}`eval echo '${'$as_ac_Header'}'`" >&6
+
+fi
+if test `eval echo '${'$as_ac_Header'}'` = yes; then
+  cat >>confdefs.h <<_ACEOF
+#define `echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+  openssl_includes="yes"
+fi
+
+done
+
+		CPPFLAGS="$CPPFLAGS_save"
+
+		if test "x$openssl_includes" != "xno" -a \
+			"x$openssl_includes" != "x"; then
+			have_openssl_includes="yes"
+
+			OPENSSL_CFLAGS="-I$with_openssl_includes"
+		else
+			OPENSSL_CFLAGS=""
+		fi
+	else
+		echo "$as_me:$LINENO: checking for OpenSSL includes" >&5
+echo $ECHO_N "checking for OpenSSL includes... $ECHO_C" >&6
+		echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
+	fi
+
+
+# Check whether --with-openssl-libs or --without-openssl-libs was given.
+if test "${with_openssl_libs+set}" = set; then
+  withval="$with_openssl_libs"
+   with_openssl_libs="$withval"
+fi;
+
+	if test "x$with_openssl_libs"     != "xno" -a \
+		"x$have_openssl_includes" != "xno"; then
+
+		LDFLAGS_save="$LDFLAGS"
+
+		case $with_openssl_libs in
+			""|-L*) ;;
+			*) with_openssl_libs="-L$with_openssl_libs" ;;
+		esac
+
+		echo "$as_me:$LINENO: checking for OpenSSL libraries" >&5
+echo $ECHO_N "checking for OpenSSL libraries... $ECHO_C" >&6
+if test "${openssl_libs+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+
+			LDFLAGS="$LDFLAGS $with_openssl_libs -lssl -lcrypto"
+			cat >conftest.$ac_ext <<_ACEOF
+#line $LINENO "configure"
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+
+/* Override any gcc2 internal prototype to avoid an error.  */
+#ifdef __cplusplus
+extern "C"
+#endif
+/* We use char because int might match the return type of a gcc2
+   builtin and then its argument prototype would still apply.  */
+char SSL_library_init ();
+int
+main ()
+{
+SSL_library_init ();
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (eval echo "$as_me:$LINENO: \"$ac_link\"") >&5
+  (eval $ac_link) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } &&
+         { ac_try='test -s conftest$ac_exeext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+  openssl_libs="yes"
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+openssl_libs="no"
+fi
+rm -f conftest.$ac_objext conftest$ac_exeext conftest.$ac_ext
+			LDFLAGS="$LDFLAGS_save"
+
+fi
+echo "$as_me:$LINENO: result: $openssl_libs" >&5
+echo "${ECHO_T}$openssl_libs" >&6
+
+		if test "x$openssl_libs" != "xno"; then
+
+cat >>confdefs.h <<\_ACEOF
+#define HAVE_OPENSSL 1
+_ACEOF
+
+			cat >>confdefs.h <<\_ACEOF
+#define HAVE_SSL 1
+_ACEOF
+
+			msg_openssl="OpenSSL"
+			OPENSSL_LIBS="$with_openssl_libs -lssl -lcrypto"
+
+			enable_openssl="yes"
+		else
+			OPENSSL_CFLAGS=""
+			OPENSSL_LIBS=""
+		fi
+	else
+		echo "$as_me:$LINENO: checking for OpenSSL libraries" >&5
+echo $ECHO_N "checking for OpenSSL libraries... $ECHO_C" >&6
+		echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
+	fi
+else
+	OPENSSL_CFLAGS=""
+	OPENSSL_LIBS=""
+fi
+
+if test "x$enable_openssl" = "xyes"; then
+  USE_OPENSSL_TRUE=
+  USE_OPENSSL_FALSE='#'
+else
+  USE_OPENSSL_TRUE='#'
+  USE_OPENSSL_FALSE=
+fi
+
 if test "x$enable_gnutls" != "xno"; then
 	enable_gnutls="no"
 	prefix=`eval echo $prefix`
@@ -33181,12 +33514,20 @@ else
 fi
 
 
-if test "x$msg_nss" != "x" -a "x$msg_gnutls" != "x"; then
+if test "x$msg_nss" != "x" -a "x$msg_gnutls" != "x" -a "x$msg_openssl" != "x"; then
+	msg_ssl="$msg_nss, $msg_gnutls, and $msg_openssl"
+elif test "x$msg_nss" != "x" -a "x$msg_gnutls" != "x"; then
 	msg_ssl="$msg_nss and $msg_gnutls"
+elif test "x$msg_nss" != "x" -a "x$msg_openssl" != "x"; then
+	msg_ssl="$msg_nss and $msg_openssl"
+elif test "x$msg_gnutls" != "x" -a "x$msg_openssl" != "x"; then
+	msg_ssl="$msg_gnutls and $msg_openssl"
 elif test "x$msg_nss" != "x"; then
 	msg_ssl=$msg_nss
 elif test "x$msg_gnutls" != "x"; then
 	msg_ssl=$msg_gnutls
+elif test "x$msg_openssl" != "x"; then
+	msg_ssl=$msg_openssl
 fi
 
 if test "$enable_tcl" = yes; then
@@ -37014,6 +37355,13 @@ echo "$as_me: error: conditional \"USE_P
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
 fi
+if test -z "${USE_OPENSSL_TRUE}" && test -z "${USE_OPENSSL_FALSE}"; then
+  { { echo "$as_me:$LINENO: error: conditional \"USE_OPENSSL\" was never defined.
+Usually this means the macro was only invoked conditionally." >&5
+echo "$as_me: error: conditional \"USE_OPENSSL\" was never defined.
+Usually this means the macro was only invoked conditionally." >&2;}
+   { (exit 1); exit 1; }; }
+fi
 if test -z "${USE_GNUTLS_TRUE}" && test -z "${USE_GNUTLS_FALSE}"; then
   { { echo "$as_me:$LINENO: error: conditional \"USE_GNUTLS\" was never defined.
 Usually this means the macro was only invoked conditionally." >&5
@@ -37866,6 +38214,10 @@ s,@PERL_LIBS@,$PERL_LIBS,;t t
 s,@PERL_MM_PARAMS@,$PERL_MM_PARAMS,;t t
 s,@DYNALOADER_A@,$DYNALOADER_A,;t t
 s,@LIBPERL_A@,$LIBPERL_A,;t t
+s,@OPENSSL_CFLAGS@,$OPENSSL_CFLAGS,;t t
+s,@OPENSSL_LIBS@,$OPENSSL_LIBS,;t t
+s,@USE_OPENSSL_TRUE@,$USE_OPENSSL_TRUE,;t t
+s,@USE_OPENSSL_FALSE@,$USE_OPENSSL_FALSE,;t t
 s,@GNUTLS_CFLAGS@,$GNUTLS_CFLAGS,;t t
 s,@GNUTLS_LIBS@,$GNUTLS_LIBS,;t t
 s,@USE_GNUTLS_TRUE@,$USE_GNUTLS_TRUE,;t t
