$OpenBSD: patch-openh323u_mak_in,v 1.5 2009/04/16 14:43:36 ajacoutot Exp $
--- openh323u.mak.in.orig	Tue May 30 13:09:24 2006
+++ openh323u.mak.in	Mon Mar  3 12:29:57 2008
@@ -166,8 +166,12 @@
 #
 
 PWLIBDIR	= @PWLIBDIR@
+ifdef BUILDSELF
 OPENH323DIR	= @OPENH323DIR@
 STDCCFLAGS	+= @STDCCFLAGS@
+else
+OPENH323DIR	= ${PREFIX}/share/openh323
+endif
 LDFLAGS		+= @LDFLAGS@
 LDLIBS		+= @LDLIBS@
 ENDLDLIBS	:= @ENDLDLIBS@ $(ENDLDLIBS)
@@ -201,15 +205,13 @@ LIBDIRS += $(OPENH323DIR)
 #OH323_SUPPRESS_H235	= 1
 
 OH323_SRCDIR = $(OPENH323DIR)/src
-ifdef PREFIX
-OH323_INCDIR = $(PREFIX)/include/openh323
+ifndef BUILDSELF
+OH323_INCDIR = ${PREFIX}/include/openh323
+OH323_LIBDIR = ${PREFIX}/lib
 else
 OH323_INCDIR = $(OPENH323DIR)/include
-endif # PREFIX
-
-ifndef OH323_LIBDIR
 OH323_LIBDIR = $(OPENH323DIR)/lib
-endif # OH323_LIBDIR
+endif
 
 ifeq ($(NOTRACE), 1)
 STDCCFLAGS += -DPASN_NOPRINTON -DPASN_LEANANDMEAN
@@ -220,8 +222,12 @@ RCFLAGS	   += -DPTRACING
 OH323_SUFFIX = $(OBJ_SUFFIX)
 endif # NOTRACE
 
-OH323_BASE  = h323_$(PLATFORM_TYPE)_$(OH323_SUFFIX)$(LIB_TYPE)
+OH323_BASE  = h323$(LIB_TYPE)
+ifdef BUILDSELF
 OH323_FILE  = lib$(OH323_BASE).$(LIB_SUFFIX)
+else
+OH323_FILE  = lib$(OH323_BASE).so.${LIBh323_VERSION}
+endif
 
 LDFLAGS	    += -L$(OH323_LIBDIR)
 LDLIBS	    := -l$(OH323_BASE) $(LDLIBS)
