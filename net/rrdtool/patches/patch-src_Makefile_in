$OpenBSD: patch-src_Makefile_in,v 1.10 2005/10/24 05:11:01 fgsch Exp $
--- src/Makefile.in.orig	2004-04-06 17:30:25.000000000 -0400
+++ src/Makefile.in	2004-06-08 15:47:47.000000000 -0400
@@ -168,7 +168,7 @@ target_os = @target_os@
 target_vendor = @target_vendor@
 
 CGI_INC_DIR = $(top_srcdir)/@CGI_LIB_DIR@
-GD_INC_DIR = $(top_srcdir)/@GD_LIB_DIR@
+GD_INC_DIR = $(LOCALBASE)/include
 @USE_INSTALLED_LIBPNG_FALSE@PNG_INC = -I$(top_srcdir)/@PNG_LIB_DIR@
 
 # If not installed in /usr/local, this will fail.
@@ -189,10 +189,6 @@ AM_CPPFLAGS = -I$(CGI_INC_DIR) -I$(GD_IN
 #LTCOMPILE = $(LIBTOOL) --mode=compile $(CC) $(DEFS) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS) $(CFLAGS_EXTRA)
 #LINK      = $(LIBTOOL) --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) $(CFLAGS_EXTRA) $(LDFLAGS) -o $@
 RRD_C_FILES = \
-	gdpng.c		\
-	getopt.c	\
-	getopt1.c	\
-	gifsize.c	\
 	parsetime.c	\
 	pngsize.c	\
 	rrd_create.c	\
@@ -210,7 +206,7 @@ RRD_C_FILES = \
 	rrd_tune.c	\
 	rrd_update.c	\
 	rrd_xport.c	\
-	rrd_graph.h rrd_xport.h getopt.h ntconfig.h \
+	rrd_graph.h rrd_xport.h ntconfig.h \
 	parsetime.h rrd_format.h rrd_tool.h rrd.h config_aux.h
 
 
@@ -223,9 +219,9 @@ RRD_C_FILES = \
 # files.
 RRD_LIBS = \
 	$(CGI_LIB_DIR)/librrd_cgi.la	\
-	$(GD_LIB_DIR)/librrd_gd.la	\
 	$(PNG_LIB)			\
-	$(ZLIB_LIB)
+	$(ZLIB_LIB)			\
+	-lgd -ljpeg -liconv
 
 
 lib_LTLIBRARIES = librrd.la
@@ -240,7 +236,7 @@ librrd_la_LDFLAGS = -version-info 0:0:0
 include_HEADERS = rrd.h
 
 librrd_private_la_LIBADD = $(RRD_LIBS)
-librrd_private_la_LDFLAGS = -static
+librrd_private_la_LDFLAGS = -prefer-pic
 
 bin_PROGRAMS = rrdcgi rrdtool rrdupdate
 
@@ -263,21 +259,17 @@ LTLIBRARIES = $(lib_LTLIBRARIES) $(noins
 
 @USE_INSTALLED_LIBPNG_FALSE@@USE_INSTALLED_ZLIB_TRUE@librrd_la_DEPENDENCIES = \
 @USE_INSTALLED_LIBPNG_FALSE@@USE_INSTALLED_ZLIB_TRUE@	$(CGI_LIB_DIR)/librrd_cgi.la \
-@USE_INSTALLED_LIBPNG_FALSE@@USE_INSTALLED_ZLIB_TRUE@	$(GD_LIB_DIR)/librrd_gd.la \
 @USE_INSTALLED_LIBPNG_FALSE@@USE_INSTALLED_ZLIB_TRUE@	$(top_builddir)/@PNG_LIB_DIR@/librrd_png.la
 @USE_INSTALLED_LIBPNG_FALSE@@USE_INSTALLED_ZLIB_FALSE@librrd_la_DEPENDENCIES = \
 @USE_INSTALLED_LIBPNG_FALSE@@USE_INSTALLED_ZLIB_FALSE@	$(CGI_LIB_DIR)/librrd_cgi.la \
-@USE_INSTALLED_LIBPNG_FALSE@@USE_INSTALLED_ZLIB_FALSE@	$(GD_LIB_DIR)/librrd_gd.la \
 @USE_INSTALLED_LIBPNG_FALSE@@USE_INSTALLED_ZLIB_FALSE@	$(top_builddir)/@PNG_LIB_DIR@/librrd_png.la \
 @USE_INSTALLED_LIBPNG_FALSE@@USE_INSTALLED_ZLIB_FALSE@	$(top_builddir)/@ZLIB_LIB_DIR@/librrd_z.la
 @USE_INSTALLED_LIBPNG_TRUE@@USE_INSTALLED_ZLIB_TRUE@librrd_la_DEPENDENCIES = \
-@USE_INSTALLED_LIBPNG_TRUE@@USE_INSTALLED_ZLIB_TRUE@	$(CGI_LIB_DIR)/librrd_cgi.la \
-@USE_INSTALLED_LIBPNG_TRUE@@USE_INSTALLED_ZLIB_TRUE@	$(GD_LIB_DIR)/librrd_gd.la
+@USE_INSTALLED_LIBPNG_TRUE@@USE_INSTALLED_ZLIB_TRUE@	$(CGI_LIB_DIR)/librrd_cgi.la
 @USE_INSTALLED_LIBPNG_TRUE@@USE_INSTALLED_ZLIB_FALSE@librrd_la_DEPENDENCIES = \
 @USE_INSTALLED_LIBPNG_TRUE@@USE_INSTALLED_ZLIB_FALSE@	$(CGI_LIB_DIR)/librrd_cgi.la \
-@USE_INSTALLED_LIBPNG_TRUE@@USE_INSTALLED_ZLIB_FALSE@	$(GD_LIB_DIR)/librrd_gd.la \
 @USE_INSTALLED_LIBPNG_TRUE@@USE_INSTALLED_ZLIB_FALSE@	$(top_builddir)/@ZLIB_LIB_DIR@/librrd_z.la
-am__objects_1 = gdpng.lo getopt.lo getopt1.lo gifsize.lo parsetime.lo \
+am__objects_1 = parsetime.lo \
 	pngsize.lo rrd_create.lo rrd_diff.lo rrd_dump.lo rrd_info.lo \
 	rrd_error.lo rrd_fetch.lo rrd_format.lo rrd_graph.lo \
 	rrd_last.lo rrd_open.lo rrd_resize.lo rrd_restore.lo \
@@ -286,19 +278,15 @@ am_librrd_la_OBJECTS = $(am__objects_1)
 librrd_la_OBJECTS = $(am_librrd_la_OBJECTS)
 @USE_INSTALLED_LIBPNG_FALSE@@USE_INSTALLED_ZLIB_TRUE@librrd_private_la_DEPENDENCIES = \
 @USE_INSTALLED_LIBPNG_FALSE@@USE_INSTALLED_ZLIB_TRUE@	$(CGI_LIB_DIR)/librrd_cgi.la \
-@USE_INSTALLED_LIBPNG_FALSE@@USE_INSTALLED_ZLIB_TRUE@	$(GD_LIB_DIR)/librrd_gd.la \
 @USE_INSTALLED_LIBPNG_FALSE@@USE_INSTALLED_ZLIB_TRUE@	$(top_builddir)/@PNG_LIB_DIR@/librrd_png.la
 @USE_INSTALLED_LIBPNG_FALSE@@USE_INSTALLED_ZLIB_FALSE@librrd_private_la_DEPENDENCIES = \
 @USE_INSTALLED_LIBPNG_FALSE@@USE_INSTALLED_ZLIB_FALSE@	$(CGI_LIB_DIR)/librrd_cgi.la \
-@USE_INSTALLED_LIBPNG_FALSE@@USE_INSTALLED_ZLIB_FALSE@	$(GD_LIB_DIR)/librrd_gd.la \
 @USE_INSTALLED_LIBPNG_FALSE@@USE_INSTALLED_ZLIB_FALSE@	$(top_builddir)/@PNG_LIB_DIR@/librrd_png.la \
 @USE_INSTALLED_LIBPNG_FALSE@@USE_INSTALLED_ZLIB_FALSE@	$(top_builddir)/@ZLIB_LIB_DIR@/librrd_z.la
 @USE_INSTALLED_LIBPNG_TRUE@@USE_INSTALLED_ZLIB_TRUE@librrd_private_la_DEPENDENCIES = \
-@USE_INSTALLED_LIBPNG_TRUE@@USE_INSTALLED_ZLIB_TRUE@	$(CGI_LIB_DIR)/librrd_cgi.la \
-@USE_INSTALLED_LIBPNG_TRUE@@USE_INSTALLED_ZLIB_TRUE@	$(GD_LIB_DIR)/librrd_gd.la
+@USE_INSTALLED_LIBPNG_TRUE@@USE_INSTALLED_ZLIB_TRUE@	$(CGI_LIB_DIR)/librrd_cgi.la
 @USE_INSTALLED_LIBPNG_TRUE@@USE_INSTALLED_ZLIB_FALSE@librrd_private_la_DEPENDENCIES = \
 @USE_INSTALLED_LIBPNG_TRUE@@USE_INSTALLED_ZLIB_FALSE@	$(CGI_LIB_DIR)/librrd_cgi.la \
-@USE_INSTALLED_LIBPNG_TRUE@@USE_INSTALLED_ZLIB_FALSE@	$(GD_LIB_DIR)/librrd_gd.la \
 @USE_INSTALLED_LIBPNG_TRUE@@USE_INSTALLED_ZLIB_FALSE@	$(top_builddir)/@ZLIB_LIB_DIR@/librrd_z.la
 am_librrd_private_la_OBJECTS = $(am__objects_1)
 librrd_private_la_OBJECTS = $(am_librrd_private_la_OBJECTS)
@@ -321,8 +309,7 @@ rrdupdate_LDFLAGS =
 DEFAULT_INCLUDES =  -I. -I$(srcdir) -I$(top_builddir)
 depcomp = $(SHELL) $(top_srcdir)/config/depcomp
 am__depfiles_maybe = depfiles
-@AMDEP_TRUE@DEP_FILES = ./$(DEPDIR)/gdpng.Plo ./$(DEPDIR)/getopt.Plo \
-@AMDEP_TRUE@	./$(DEPDIR)/getopt1.Plo ./$(DEPDIR)/gifsize.Plo \
+@AMDEP_TRUE@DEP_FILES = \
 @AMDEP_TRUE@	./$(DEPDIR)/parsetime.Plo ./$(DEPDIR)/pngsize.Plo \
 @AMDEP_TRUE@	./$(DEPDIR)/rrd_cgi.Po ./$(DEPDIR)/rrd_create.Plo \
 @AMDEP_TRUE@	./$(DEPDIR)/rrd_diff.Plo ./$(DEPDIR)/rrd_dump.Plo \
@@ -443,10 +430,6 @@ mostlyclean-compile:
 distclean-compile:
 	-rm -f *.tab.c
 
-@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/gdpng.Plo@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/getopt.Plo@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/getopt1.Plo@am__quote@
-@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/gifsize.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/parsetime.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/pngsize.Plo@am__quote@
 @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/rrd_cgi.Po@am__quote@
