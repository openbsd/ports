$OpenBSD: patch-configure,v 1.9 2010/12/21 14:59:49 ajacoutot Exp $
--- configure.orig	Mon Dec 20 22:39:51 2010
+++ configure	Tue Dec 21 15:09:50 2010
@@ -18015,13 +18015,13 @@ fi
 # Thread lib detection
 ac_fn_c_check_func "$LINENO" "pthread_cond_timedwait" "ac_cv_func_pthread_cond_timedwait"
 if test "x$ac_cv_func_pthread_cond_timedwait" = x""yes; then :
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for pthread_cond_timedwait in -lpthread" >&5
-$as_echo_n "checking for pthread_cond_timedwait in -lpthread... " >&6; }
+  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for pthread_cond_timedwait in -pthread" >&5
+$as_echo_n "checking for pthread_cond_timedwait in -pthread... " >&6; }
 if test "${ac_cv_lib_pthread_pthread_cond_timedwait+set}" = set; then :
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lpthread  $LIBS"
+LIBS="-pthread  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
@@ -18052,7 +18052,7 @@ fi
 { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_pthread_pthread_cond_timedwait" >&5
 $as_echo "$ac_cv_lib_pthread_pthread_cond_timedwait" >&6; }
 if test "x$ac_cv_lib_pthread_pthread_cond_timedwait" = x""yes; then :
-  THREAD_LIBS="-lpthread"
+  THREAD_LIBS="-pthread"
 fi
 
 fi
@@ -18267,13 +18267,13 @@ if test x$have_selinux = xyes ; then
 if test "x$ac_cv_func_pthread_create" = x""yes; then :
 
 else
-  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for pthread_create in -lpthread" >&5
-$as_echo_n "checking for pthread_create in -lpthread... " >&6; }
+  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for pthread_create in -pthread" >&5
+$as_echo_n "checking for pthread_create in -pthread... " >&6; }
 if test "${ac_cv_lib_pthread_pthread_create+set}" = set; then :
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lpthread  $LIBS"
+LIBS="-pthread  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
@@ -18304,7 +18304,7 @@ fi
 { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_pthread_pthread_create" >&5
 $as_echo "$ac_cv_lib_pthread_pthread_create" >&6; }
 if test "x$ac_cv_lib_pthread_pthread_create" = x""yes; then :
-  SELINUX_THREAD_LIBS="-lpthread"
+  SELINUX_THREAD_LIBS="-pthread"
 fi
 
 fi
@@ -19608,7 +19608,10 @@ if test "x$GCC" = "xyes"; then
      ;;
   esac
 
-  case " $CFLAGS " in
+  case $host in
+  arm-*-openbsd*) ;;
+  hppa-*-openbsd*) ;;
+  *) case " $CFLAGS " in
   *[\ \	]-fPIE[\ \	]*) ;;
   *) if test x$dbus_win = xno && cc_supports_flag -fPIE; then
         PIE_CFLAGS="-fPIE"
@@ -19620,6 +19623,7 @@ if test "x$GCC" = "xyes"; then
      fi
      ;;
   esac
+  esac
 
   ### Disabled warnings, and compiler flag overrides
 
@@ -19636,13 +19640,6 @@ if test "x$GCC" = "xyes"; then
   case " $CFLAGS " in
   *[\ \	]-Wno-sign-compare[\ \	]*) ;;
   *) CFLAGS="$CFLAGS -Wno-sign-compare" ;;
-  esac
-  case " $CFLAGS " in
-  *[\ \	]-Wno-pointer-sign[\ \	]*) ;;
-  *) if cc_supports_flag -Wno-pointer-sign; then
-        CFLAGS="$CFLAGS -Wno-pointer-sign"
-     fi
-     ;;
   esac
 
   # This one is special - it's not a warning override.
