Index: channels/tsmf/client/ffmpeg/tsmf_ffmpeg.c
--- channels/tsmf/client/ffmpeg/tsmf_ffmpeg.c.orig
+++ channels/tsmf/client/ffmpeg/tsmf_ffmpeg.c
@@ -624,11 +624,18 @@ static void tsmf_ffmpeg_free(ITSMFDecoder* decoder)
 
 	if (mdecoder->codec_context)
 	{
+
+#if LIBAVCODEC_VERSION_INT < AV_VERSION_INT(55, 69, 100)
 		if (mdecoder->prepared)
 			avcodec_close(mdecoder->codec_context);
+#endif
 
 		free(mdecoder->codec_context->extradata);
+#if LIBAVCODEC_VERSION_INT >= AV_VERSION_INT(55, 69, 100)
+		avcodec_free_context(&mdecoder->codec_context);
+#else
 		av_free(mdecoder->codec_context);
+#endif
 	}
 
 	free(decoder);
