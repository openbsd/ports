$OpenBSD: patch-mapivi,v 1.1.1.1 2007/05/29 17:08:59 ajacoutot Exp $
--- mapivi.orig	Tue Oct 31 04:21:59 2006
+++ mapivi	Tue May 29 18:56:03 2007
@@ -341,7 +341,7 @@ my $nrToConvert     = 0;
 my $maxCommentLength = 2**16 - 3; # a comment block may have max 64kB
 
 my $trashdir        = "$configdir/trash";     # the trashcan
-my $plugindir       = "$configdir/PlugIns";   # the mapivi plugin dir
+my $plugindir       = "!!LOCALBASE!!/share/mapivi/PlugIns";   # the mapivi plugin dir
 my $iptcdir         = "$configdir/IPTC_templates";  # the IPTC templates directory
 my $configFile      = "$configdir/mapivirc";  # the configuration file
 my $file_Entry_values = "$configdir/Entry_values";
@@ -422,7 +422,7 @@ my %new_keywords;
 my %ignore_keywords;
 
 # external programs used by mapivi
-my %exprogs = qw/convert 0 composite 0 jhead 0 jpegtran 0 jpegpixi 0 mogrify 0 gimp-remote 0 gimp-win-remote 0 montage 0 xwd 0 identify 0 thunderbird 0 exiftool 0/;
+my %exprogs = qw/convert 0 composite 0 jhead 0 jpegtran 0 jpegpixi 0 mogrify 0 gimp-remote 0 montage 0 identify 0 exiftool 0/;
 # short comment about the usage of the external programs
 my %exprogscom = (
 		   "convert"        => "build thumbnails",
@@ -433,10 +433,7 @@ my %exprogscom = (
 		   "mogrify"        => "change the size/quality of pictures",
 		   "montage"        => "combine pictures to e.g. index prints",
 		   "gimp-remote"    => "edit pictures with The GIMP (only UNIX)",
-		   "gimp-win-remote"=> "edit pictures with The GIMP (only windows)",
-		   "xwd"            => "make a screenshot of a window or desktop",
 		   "identify"       => "describe the format and characteristics of a picture",
-		   "thunderbird"    => "send pictures via email",
 		   "exiftool"       => "Read/write meta information in image files",
 		  );
 # where to find the external programs (resources)
@@ -449,9 +446,7 @@ my %exprogsres = (
 		   "mogrify"        => "Image Magick http://www.imagemagick.org",
 		   "montage"        => "Image Magick http://www.imagemagick.org",
 		   "gimp-remote"    => "The GIMP http://www.gimp.org",
-		   "gimp-win-remote"=> "gimp-win-remote http://sourceforge.net/projects/gimp-win-remote/",
 		   "identify"       => "Image Magick http://www.imagemagick.org",
-		   "thunderbird"    => "http://www.mozilla.org/projects/thunderbird/",
 		   "exiftool"       => "http://owl.phy.queensu.ca/~phil/exiftool/",	
 		  );
 
@@ -505,7 +500,7 @@ my %config = (
 			  "ColorThumbBG"    => "azure3",
 			  "ColorProgress"   => "#106dba",
 			  "ColorPicker"     => "red", # last color selected with color picker
-			  "DefaultThumb"    => "$configdir/EmptyThumb.jpg",
+			  "DefaultThumb"    => "!!LOCALBASE!!/share/mapivi/EmptyThumb.jpg",
 			  "Copyright"       => "copyright (c) $copyright_year Herrmann",
 			  "Comment"         => "This picture was taken in south africa ...",
 			  "MaxProcs"        => 1,
@@ -1854,9 +1849,7 @@ sub startup {
   if ($config{NrOfRuns} == 0) {
 	#whereIsPerl();
 	makeConfigDir();
-	copyConfigPics();
 	copyOtherStuff();
-	copyPlugIns();
   }
   $config{NrOfRuns}++;
   gratulation() if (($config{NrOfRuns} % 1000 == 0) and ($config{NrOfRuns} > 0)); # modulo
@@ -13073,8 +13066,6 @@ sub createMenubar {
 						}
 						slideshow();
 					  }, -accelerator => "<s>");
- $view_menu->command(-label => "use actual picture as desktop background",
-					  -command => \&setBackground);
  $view_menu->command(-label => "smart update",
 					  -command => sub { smart_update(); });
 
@@ -13217,7 +13208,6 @@ sub addFileActionsMenu {
   $fop_menu->command(-label => "copy to ...",    -command => sub { copyPicsDialog(COPY, $lb); } );
   $fop_menu->command(-label => "link to ...",    -command => \&linkPicsDialog) if (!$EvilOS);
   $fop_menu->command(-label => "move to ...",    -command => sub { movePicsDialog($lb); } );
-  $fop_menu->command(-label => "send to ...",    -command => sub { sendTo($lb); } );
   $fop_menu->command(-label => "convert ...",    -command => sub { convertPics($lb); } );
   $fop_menu->command(-label => "copy to print ...", -command => sub { copyToPrint($lb); }, -accelerator => "<Ctrl-p>");
   $fop_menu->command(-label => "rename ...",     -command => sub { renamePic($lb); }, -accelerator => "<r>");
@@ -15630,7 +15620,7 @@ sub makeButton {
 	my $picName      = shift;
 	my $func         = shift;
 
-	my $pic   = "$configdir/$picName";
+	my $pic   = "!!LOCALBASE!!/share/mapivi/$picName";
 	my $image = $parentWidget->Photo(-file => $pic) if -f $pic;
 
 	if ($image) {
@@ -17178,7 +17168,6 @@ If this option is enabled one viewer will be started l
 "viewer pic1.jpg pic2.jpg pic3.jpg",
 if not 3 viewers will be started like this:
 "viewer pic1.jpg" "viewer pic2.jpg" "viewer pic3.jpg".');
-  labeledEntry($dF, 'top', $w, "Tool to set the desktop background",\$tmpconf{ExtBGApp});
 
   # ###############  button frame  ########################
 
