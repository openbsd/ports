$OpenBSD: patch-fxtv_cnvt_sh,v 1.4 2006/10/18 11:10:31 ajacoutot Exp $
--- fxtv_cnvt.sh.orig	Mon Feb 12 22:18:40 2001
+++ fxtv_cnvt.sh	Wed Oct 18 12:38:30 2006
@@ -40,12 +40,12 @@
 
 # Default to $PATH
 if [ -z "$PATH_FXTV" ]; then
-   PATH_FXTV="fxtv"
+   PATH_FXTV="%%LOCALBASE%%/bin/fxtv"
 fi
-PATH_SOX="sox"
-PATH_MPEG_MUSICIN="mpeg_musicin"
-PATH_MPEG_ENCODE="mpeg_encode"
-PATH_MPLEX="mplex"
+PATH_SOX="%%LOCALBASE%%/bin/sox"
+PATH_MPEG_MUSICIN="%%LOCALBASE%%/bin/mp3encode"
+PATH_MPEG_ENCODE="%%LOCALBASE%%/bin/mpeg_encode"
+PATH_MPLEX="%%LOCALBASE%%/bin/mplex"
 
 #--------------------- MPEG_ENCODE PARAMETER FILE TEMPLATES ------------------
 
@@ -54,39 +54,39 @@ MPEG_ENC_PARAM_STR_HEADER=\
 # "mpeg_encode" parameter file; generated by BSD X TV
 # 
 
-PATTERN           IBPBIBPBPB  
-GOP_SIZE          10          
-SLICES_PER_FRAME  1           
-PIXEL             HALF        
-RANGE             8           
-PSEARCH_ALG       LOGARITHMIC 
-BSEARCH_ALG       SIMPLE      
-IQSCALE           8           
-PQSCALE           10          
-BQSCALE           25          
-FRAME_RATE        __FPS__     
-REFERENCE_FRAME   ORIGINAL    
-YUV_SIZE          __XRES__x__YRES__ 
+PATTERN           IBPBIBPBPB
+GOP_SIZE          10
+SLICES_PER_FRAME  1
+PIXEL             HALF
+RANGE             8
+PSEARCH_ALG       LOGARITHMIC
+BSEARCH_ALG       SIMPLE
+IQSCALE           4
+PQSCALE           4
+BQSCALE           12
+FRAME_RATE        __FPS__
+REFERENCE_FRAME   ORIGINAL
+YUV_SIZE          __XRES__x__YRES__
 OUTPUT            __OUTFILE__'
 
 MPEG_ENC_PARAM_STR_TIFF=\
 'BASE_FILE_FORMAT  PPM
-INPUT_CONVERT     tifftopnm *'
+INPUT_CONVERT     %%LOCALBASE%%/bin/tifftopnm *'
 
 MPEG_ENC_PARAM_STR_PPM=\
-'BASE_FILE_FORMAT  PPM         
+'BASE_FILE_FORMAT  PPM
 INPUT_CONVERT     *'
 
 MPEG_ENC_PARAM_STR_IYUV=\
-'BASE_FILE_FORMAT  YUV         
-INPUT_CONVERT     *           
+'BASE_FILE_FORMAT  YUV
+INPUT_CONVERT     *
 YUV_FORMAT        EYUV'
 
 MPEG_ENC_PARAM_STR_INP_FILES=\
 'INPUT_DIR         __FRAMEDIR__
-INPUT                         
-__FRAMEBASE__.*.__FRAMEEXT__  [00001-__NUMFRAMES__]          
-END_INPUT'                     
+INPUT
+__FRAMEBASE__.*.__FRAMEEXT__  [00001-__NUMFRAMES__]
+END_INPUT'
 
 MPEG_ENC_PARAM_STR_INP_STDIN=\
 'INPUT_DIR         stdin'
@@ -181,8 +181,8 @@ GenAudioPipe() {
 
    # Do we need an intermediate file?
    if [ $mpeg_enc = YES ]; then
-      out_soxfn="$out_fnbase.aiff"
-      out_soxfmt="AIFF"
+      out_soxfn="$out_fnbase.raw"
+      out_soxfmt="RAW"
    else
       out_soxfn="$GAout_fn"
       out_soxfmt="$out_fmt"
@@ -344,12 +344,8 @@ vars='$AV_RAW_FILES $AV_TARGET $TARGET_F
 set -- $vars
 missing_var=NO
 while [ $# -gt 0 ]; do
-   if [ -z "`eval echo $1`" ]; then
-      echo "Missing setting: $1"
-      missing_var=YES
-   fi
    shift
-   done
+done
 
 if [ $missing_var = YES ]; then
    exit 1
