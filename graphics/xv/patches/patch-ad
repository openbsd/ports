--- Imakefile.orig	Fri Jan 13 12:24:01 1995
+++ Imakefile	Sat Aug 22 21:40:57 1998
@@ -6,13 +6,22 @@
 /* if, for whatever reason, you're unable to get the JPEG library to compile
  * on your machine, *COMMENT OUT* the following line
  */
-#define HaveJpeg
+/* #define HaveJpeg */
+#define UseInstalledJpeg
 
 
 /* if, for whatever reason, you're unable to get the TIFF library to compile
  * on your machine, *COMMENT OUT* the following line
  */
-#define HaveTiff
+/* #define HaveTiff */
+#define UseInstalledTiff
+
+
+/* if, for whatever reason, you're unable to get the NNG library to compile
+ * on your machine, *COMMENT OUT* the following line
+ */
+/* #define HavePng */
+#define UseInstalledPng
 
 
 /* if, for whatever reason, you're unable to get the PDS/VICAR support
@@ -119,16 +128,44 @@
 JPEG = -DDOJPEG
 JPEGDIR = jpeg
 LIBJPEG = $(JPEGDIR)/libjpeg.a
+DEPLIBJPEG = $(LIBJPEG)
 JPEGINCLUDE = -I$(JPEGDIR)
 #endif
 
+#ifdef UseInstalledJpeg
+JPEG = -DDOJPEG
+LIBJPEG = -L/usr/local/lib -ljpeg
+JPEGINCLUDE = -I/usr/local/include
+#endif
+
 #ifdef HaveTiff
 TIFF = -DDOTIFF
 TIFFDIR = tiff
 LIBTIFF = $(TIFFDIR)/libtiff.a
+DEPLIBTIFF = $(LIBTIFF)
 TIFFINCLUDE = -I$(TIFFDIR)
 #endif
 
+#ifdef UseInstalledTiff
+TIFF = -DDOTIFF
+LIBTIFF = -L/usr/local/lib -ltiff
+TIFFINCLUDE = -I/usr/local/include
+#endif
+
+#ifdef HavePng
+PNG    = -DDOPNG
+PNGDIR = png
+LIBPNG = $(PNGDIR)/libpng.a
+DEPLIBPNG = $(LIBPNG)
+PNGINCLUDE = -I$(PNGDIR)
+#endif
+
+#ifdef UseInstalledPng
+PNG = -DDOPNG
+LIBPNG = -L/usr/local/lib -lpng
+PNGINCLUDE = -I$(LOCALBASE)/include/libpng
+#endif
+
 #ifdef HavePDS
 PDS = -DDOPDS
 #endif
@@ -138,18 +175,18 @@
 SCO= -Dsco -DPOSIX -DNO_RANDOM 
 SYS_LIBRARIES=        -lm -lc -lx 
 #else
-SYS_LIBRARIES=        -lm
+SYS_LIBRARIES=        -lm -lz
 #endif
 
 
-DEPLIBS = $(LIBJPEG) $(LIBTIFF)
-LOCAL_LIBRARIES = $(XLIB) $(DEPLIBS)
+DEPLIBS = $(DEPLIBJPEG) $(DEPLIBTIFF) $(DEPLIBPNG)
+LOCAL_LIBRARIES = $(XLIB) $(LIBJPEG) $(LIBTIFF) $(LIBPNG)
 
 DEFINES= $(SCO) $(UNIX) $(NODIRENT) $(VPRINTF) $(TIMERS) \
-	$(HPUX7) $(JPEG) $(TIFF) $(PDS) $(DXWM) $(RAND) \
+	$(HPUX7) $(JPEG) $(TIFF) $(PNG) $(PDS) $(DXWM) $(RAND) \
 	$(BACKING_STORE) $(BSDTYPES) $(SGI)
 
-INCLUDES = $(JPEGINCLUDE) $(TIFFINCLUDE)
+INCLUDES = $(JPEGINCLUDE) $(TIFFINCLUDE) $(PNGINCLUDE)
 
 SRCS1 =	xv.c xvevent.c xvroot.c xvmisc.c xvimage.c xvcolor.c xvsmooth.c \
 	xv24to8.c xvgif.c xvpm.c xvinfo.c xvctrl.c xvscrl.c xvalg.c \
@@ -157,7 +194,7 @@
 	xvdial.c xvgraf.c xvsunras.c xvjpeg.c xvps.c xvpopup.c xvdflt.c \
 	xvtiff.c xvtiffwr.c xvpds.c xvrle.c xviris.c xvgrab.c vprintf.c \
 	xvbrowse.c xvtext.c xvpcx.c xviff.c xvtarga.c xvxpm.c xvcut.c \
-	xvxwd.c xvfits.c
+	xvxwd.c xvfits.c xvpng.c
 
 OBJS1 =	xv.o xvevent.o xvroot.o xvmisc.o xvimage.o xvcolor.o xvsmooth.o \
 	xv24to8.o xvgif.o xvpm.o xvinfo.o xvctrl.o xvscrl.o xvalg.o \
@@ -165,7 +202,7 @@
 	xvdial.o xvgraf.o xvsunras.o xvjpeg.o xvps.o xvpopup.o xvdflt.o \
 	xvtiff.o xvtiffwr.o xvpds.o xvrle.o xviris.o xvgrab.o vprintf.o \
 	xvbrowse.o xvtext.o xvpcx.o xviff.o xvtarga.o xvxpm.o xvcut.o \
-	xvxwd.o xvfits.o
+	xvxwd.o xvfits.o xvpng.o
 
 SRCS2=	bggen.c
 OBJS2=	bggen.o
@@ -233,6 +270,18 @@
 #endif
 
 
+#ifdef HavePng
+$(LIBPNG):
+	cd $(PNGDIR); $(MAKE) libpng.a
+ 
+clean::
+	@echo "  cleaning in $(PNGDIR) ..."
+	@echo ""
+	( cd $(PNGDIR) ; $(MAKE) clean )
+	@echo ""
+#endif
+
+
 
 SRCS = $(SRCS1) $(SRCS2) $(SRCS3) $(SRCS4)
   
@@ -268,5 +317,5 @@
 
 tar:
 	tar cf xv.tar Makefile* Imakefile *.c *.h bits docs \
-		 docs unsupt vms $(JPEGDIR) $(TIFFDIR) $(MISC)
+		 docs unsupt vms $(JPEGDIR) $(TIFFDIR) $(PNGDIR) $(MISC)
 
