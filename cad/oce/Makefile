# $OpenBSD: Makefile,v 1.2 2019/11/07 13:58:14 sthen Exp $

COMMENT =	C++ 3d modeling library
DPB_PROPERTIES = parallel

GH_ACCOUNT =	tpaviot
GH_PROJECT =	oce
GH_TAGNAME =	OCE-0.18.3
PKGNAME =	${GH_TAGNAME:L}

.for LIB in FWOSPlugin PTKernel TKBO TKBRep TKBin TKBinL TKBinTObj TKBinXCAF \
	TKBool TKCAF TKCDF TKFeat TKFillet TKG2d TKG3d TKGeomAlgo TKGeomBase \
	TKHLR TKIGES TKLCAF TKMath TKMesh TKMeshVS TKNIS TKOffset TKOpenGl \
	TKPCAF TKPLCAF TKPShape TKPrim TKSTEP TKSTEP209 TKSTEPAttr TKSTEPBase \
	TKSTL TKService TKShHealing TKShapeSchema TKStdLSchema TKStdSchema \
	TKTObj TKTopAlgo TKV3d TKVRML TKVoxel TKXCAF TKXCAFSchema TKXDEIGES \
	TKXDESTEP TKXMesh TKXSBase TKXml TKXmlL TKXmlTObj TKXmlXCAF TKernel \
	TKDCAF TKDraw TKTObjDRAW TKTopTest TKViewerTest TKXDEDRAW TKXSDRAW
SHARED_LIBS += ${LIB} 0.0
.endfor

CATEGORIES =		cad

# LGPLv2.1
PERMIT_PACKAGE =	Yes

WANTLIB += ${MODTK_WANTLIB} ${COMPILER_LIBCXX}
WANTLIB += GL GLU ICE SM X11 Xext c freetype m pthread

NO_TEST =		Yes

COMPILER =		base-clang ports-gcc

MODULES =		devel/cmake \
			x11/tk
MODTK_VERSION =		8.6

LIB_DEPENDS =		${MODTK_LIB_DEPENDS}

CONFIGURE_ARGS +=	-DCMAKE_CXX_FLAGS="-I${X11BASE}/include ${CXXFLAGS}" \
			-DOCE_BUILD_SHARED_LIB=ON \
			-DOCE_WITH_FREEIMAGE=ON \
			-DOCE_WITH_GL2PS=ON \
			-DOCE_DRAW=ON \
			-DOCE_MODEL=ON \
			-DOCE_OCAF=ON

.include <bsd.port.mk>
