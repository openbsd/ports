--- Makefile.orig	Wed Dec 16 04:34:09 1998
+++ Makefile	Sat Jan  2 17:04:51 1999
@@ -5,10 +5,10 @@
 #   @(#)$Id: patch-aa,v 1.2 1999/01/04 05:28:48 marc Exp $
 #
 
-PREFIX?=/usr/local
 BINDIR=$(PREFIX)/bin
-ETCDIR=$(PREFIX)/etc
 MANDIR=$(PREFIX)/man
+LIBDIR=$(PREFIX)/lib/tosha
+ETCDIR=/etc
 
 ###################################################
 ######                                       ######
@@ -16,17 +16,7 @@
 ######                                       ######
 ###################################################
 
-CFLAGS?=-O2
-CFLAGS+=-Wall -ansi -DGLOBAL_ETC_DIR=\"$(ETCDIR)\"
-
-.if (exists(/usr/include/camlib.h))
-CFLAGS+=-DCAM
-LDFLAGS=-lcam
-.else
-LDFLAGS=-lscsi
-.endif
-
-GZIP_CMD?=gzip -9
+CFLAGS=-O2 -ansi -DGLOBAL_ETC_DIR=\"$(ETCDIR)\"
 
 BINS=tosha pcmplay pcmfade
 OBJS=utils.o getlopt.o tosha.o toscsi.o toform.o toconf.o pcmplay.o pcmfade.o
@@ -43,25 +33,22 @@
 pcmfade.o:	pcmfade.c utils.h
 
 tosha:	tosha.o toscsi.o toform.o toconf.o utils.o getlopt.o
-	$(CC) $(CFLAGS) -o tosha \
-	    tosha.o toscsi.o toform.o toconf.o utils.o getlopt.o $(LDFLAGS)
+	$(CC) $(CFLAGS) -o tosha tosha.o toscsi.o toform.o toconf.o \
+		utils.o getlopt.o -lutil -lossaudio
 
 pcmplay:	pcmplay.o utils.o getlopt.o
-	$(CC) $(CFLAGS) -o pcmplay pcmplay.o utils.o getlopt.o
+	$(CC) $(CFLAGS) -o pcmplay pcmplay.o utils.o getlopt.o -lossaudio
 
 pcmfade:	pcmfade.o utils.o
 	$(CC) $(CFLAGS) -o pcmfade pcmfade.o utils.o
 
 install:	$(BINS)
 	strip $(BINS)
-	install -s -g bin -o bin -m 755 $(BINS) $(BINDIR)
-	install -c -g bin -o bin -m 644 tosharc $(ETCDIR)
-	install -c -g bin -o bin -m 644 tosha.1 pcmplay.1 pcmfade.1 \
+	install -s -o root -g bin -m 755 $(BINS) $(BINDIR)
+	install -d -o root -g wheel -m 755 $(LIBDIR)
+	install -c -o root -g wheel -m 644 tosharc $(LIBDIR)/tosharc.sample
+	install -c -o root -g wheel -m 644 tosha.1 pcmplay.1 pcmfade.1 \
 		$(MANDIR)/man1
-.if !defined(NOMANCOMPRESS)
-	cd $(MANDIR)/man1 ; \
-	$(GZIP_CMD) tosha.1 pcmplay.1 pcmfade.1
-.endif
 
 clean:
 	rm -f $(OBJS) *core $(BINS)
