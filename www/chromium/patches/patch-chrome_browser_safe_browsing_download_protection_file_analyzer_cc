$OpenBSD: patch-chrome_browser_safe_browsing_download_protection_file_analyzer_cc,v 1.1 2021/10/20 10:27:45 robert Exp $

Index: chrome/browser/safe_browsing/download_protection/file_analyzer.cc
--- chrome/browser/safe_browsing/download_protection/file_analyzer.cc.orig
+++ chrome/browser/safe_browsing/download_protection/file_analyzer.cc
@@ -19,7 +19,7 @@
 #include "components/safe_browsing/core/common/features.h"
 #include "content/public/browser/browser_thread.h"
 
-#if defined(OS_LINUX) || defined(OS_WIN)
+#if defined(OS_LINUX) || defined(OS_WIN) | defined(OS_BSD)
 #include "chrome/browser/safe_browsing/download_protection/document_analysis_service.h"
 #endif
 
@@ -100,7 +100,7 @@ void FileAnalyzer::Start(const base::FilePath& target_
   } else if (inspection_type == DownloadFileType::DMG) {
     StartExtractDmgFeatures();
 #endif
-#if defined(OS_LINUX) || defined(OS_WIN)
+#if defined(OS_LINUX) || defined(OS_WIN) || defined(OS_BSD)
   } else if (base::FeatureList::IsEnabled(
                  safe_browsing::kClientSideDetectionDocumentScanning) &&
              inspection_type == DownloadFileType::OFFICE_DOCUMENT) {
@@ -292,7 +292,7 @@ void FileAnalyzer::OnDmgAnalysisFinished(
 }
 #endif  // defined(OS_MAC)
 
-#if defined(OS_LINUX) || defined(OS_WIN)
+#if defined(OS_LINUX) || defined(OS_WIN) || defined(OS_BSD)
 void FileAnalyzer::StartExtractDocumentFeatures() {
   DCHECK_CURRENTLY_ON(BrowserThread::UI);
 
