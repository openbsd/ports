$OpenBSD: patch-configure,v 1.4 2003/08/15 11:33:04 wilfried Exp $
--- configure.orig	2003-06-09 01:18:42.000000000 +0200
+++ configure	2003-08-15 11:10:16.000000000 +0200
@@ -11708,6 +11708,7 @@ cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 $ac_includes_default
+#include <X11/Xlib.h>
 #include <X11/extensions/Xinerama.h>
 _ACEOF
 rm -f conftest.$ac_objext
@@ -11743,6 +11744,7 @@ _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
+#include <X11/Xlib.h>
 #include <X11/extensions/Xinerama.h>
 _ACEOF
 if { (eval echo "$as_me:$LINENO: \"$ac_cpp conftest.$ac_ext\"") >&5
@@ -11839,6 +11841,10 @@ USE_PTHREADS=
 _PTHREAD_CFLAGS=""
 _PTHREAD_LDFLAGS=""
 case "$OS_ARCH" in
+	OpenBSD)
+		USE_PTHREADS=1
+		_PTHREAD_CFLAGS="-pthread -D_THREAD_SAFE"
+		_PTHREAD_LDFLAGS="";;
 	NetBSD)
 		;;
 	FreeBSD)
@@ -12340,9 +12346,7 @@ sed 's/^/| /' conftest.$ac_ext >&5
 fi
 rm -f conftest.$ac_objext conftest.$ac_ext
 
-CC="$_save_cc"
-
-LDFLAGS="$_save_ldflags -L$_mozilla_lib_place $_mozilla_all_nspr_flags -lgtksuperwin"
+LDFLAGS="$_save_ldflags -L$_mozilla_lib_place $_mozilla_all_nspr_flags -lgtksuperwin $GTK_LIBS"
 echo "$as_me:$LINENO: checking for gdk_superwin_get_type in -lgtksuperwin" >&5
 echo $ECHO_N "checking for gdk_superwin_get_type in -lgtksuperwin... $ECHO_C" >&6
 if test "${ac_cv_lib_gtksuperwin_gdk_superwin_get_type+set}" = set; then
@@ -12402,14 +12406,14 @@ if test $ac_cv_lib_gtksuperwin_gdk_super
 fi
 
 
-LDFLAGS="$_save_ldflags -L$_mozilla_lib_place $_mozilla_all_nspr_flags -lgtkembedmoz $_mozilla_xpcom_libs $_mozilla_gtk_super_win_libs"
+LDFLAGS="$_save_ldflags -L$_mozilla_lib_place $_mozilla_all_nspr_flags -lgtkembedmoz $_mozilla_xpcom_libs $_mozilla_gtk_super_win_libs $GTK_LIBS"
 echo "$as_me:$LINENO: checking for gtk_moz_embed_get_type in -lgtkembedmoz" >&5
 echo $ECHO_N "checking for gtk_moz_embed_get_type in -lgtkembedmoz... $ECHO_C" >&6
 if test "${ac_cv_lib_gtkembedmoz_gtk_moz_embed_get_type+set}" = set; then
   echo $ECHO_N "(cached) $ECHO_C" >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-lgtkembedmoz  $LIBS"
+LIBS="-lgtkembedmoz $_PTHREAD_LDFLAGS $LIBS"
 cat >conftest.$ac_ext <<_ACEOF
 #line $LINENO "configure"
 /* confdefs.h.  */
